vector<int> primes_list = {993146723,996752089,993912011,993276811,990439561,999134321,1000034863,990310561,1002852971,990902071,1002552547,1004791829,1006000901,1000242487,998810363,998510393,1005429353,1006591627,1007173513,1001089151,1007873257,1002742243,997222561,995034571,993148837,1007335169,1007688763,1000458911,995690771,1000963499,1004540941,996669341,1009791163,1005362731,990259279,1004949923,999257549,994083157,997000859,991488709,990129697,991686341,1006200047,995269721,998938153,1001274091,1008215713,1005259139,990913177,1000705361,992677943,1001761259,1008933127,991650763,1003413907,1001591489,999972499,1001013547,996769511,1001061553,998571107,1005498281,1004864467,1008537151,995490059,994271963,1000330937,1007601659,999935701,1007473871,1005960979,1009408901,1003306259,1001731277,993759673,1005202493,994289501,992293103,1007638627,991446553,991299677,1007753729,1003063247,1008357107,995452751,995169853,993065287,1009534639,991566083,995628827,992550289,993078701,1009667231,996338407,996761473,1008855797,1005879461,1000745609,997377253,1000759181};
int base, mod;
vector<int> modPow;

struct __hash {
    vector<int> h;
 
    inline void init(const vector<int> &a) {
        if (base == 0) {
            mt19937 rngHash(chrono::high_resolution_clock::now().time_since_epoch().count());
            mod = primes_list[rngHash() % (int) primes_list.size()];
            base = rngHash() % (mod - 2) + 2;
        }
        
        int n = (int) a.size();
        h.resize(n);
        
        int sz = (int) modPow.size();
        if (sz <= n) {
            modPow.resize(n + 1);
            modPow[0] = 1;
            for (int i = max(1, sz); i <= n; i++)
                modPow[i] = 1ll * modPow[i - 1] * base % mod;
        }

        for (int i = 0; i < n; i++) {
            h[i] = a[i] % mod;
            if (i > 0) h[i] = (1ll * h[i - 1] * base + h[i]) % mod;
        }
    }
 
    inline void init(const string &s) {
        int n = (int) s.size();
        vector<int> a(n);
        for (int i = 0; i < n; i++) a[i] = (int) s[i];
        init(a);
    }
 
    inline int get(int l, int r) {
        assert(l <= r);
        int res = h[r];
        if (l > 0){
            res -= (long long) modPow[r - l + 1] * h[l - 1] % mod;
            if (res < 0) res += mod;
        }
        return res;
    }

    inline bool same(int l1, int r1, int l2, int r2) {
        return get(l1, r1) == get(l2, r2);
    }
};